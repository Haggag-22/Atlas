# IAM-focused campaign (identity + permissions + trust + simulation)
id: iam-focus-001
name: "IAM Reconnaissance"
description: "Discover identity and permissions, then simulate policy for a role."
mitre_techniques:
  - "T1078"
  - "T1069"
  - "T1098"

steps:
  - technique_id: identity_discovery
    parameters: {}

  - technique_id: role_trust_analysis
    parameters: {}

  - technique_id: permission_enumeration
    parameters: {}

  # Optional: run simulation for first role found (use step_outputs from previous steps in real use)
  - technique_id: iam_policy_simulation
    name: "Simulate policy for a role"
    parameters:
      principal_arn: "arn:aws:iam::123456789012:role/ExampleRole"  # Replace with real role ARN from state
      action_names:
        - "s3:GetObject"
        - "s3:ListBucket"
        - "iam:CreateUser"
