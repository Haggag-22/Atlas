{"hypothesisId": "H7", "location": "engine.py:collector_loop", "message": "enabled collectors", "data": {"enabled": ["identity", "policy", "trust", "guardrail", "logging_config", "resource", "backup", "permission_resolver"], "registry_keys": ["identity", "policy", "trust", "guardrail", "logging_config", "resource", "backup", "permission_resolver"]}, "timestamp": 1771061749.533952}
{"hypothesisId": "H6", "location": "engine.py:collector_failed", "message": "collector EXCEPTION", "data": {"collector": "identity", "error": "An error occurred (AccessDenied) when calling the ListUsers operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: iam:ListUsers on resource: arn:aws:iam::546493288314:user/ because no identity-based policy allows the iam:ListUsers action", "traceback": "Traceback (most recent call last):\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/engine.py\", line 234, in run\n    stats = await collector.collect(account_id, region)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/collectors/identity.py\", line 55, in collect\n    raw_users = await async_paginate(iam, \"list_users\", \"Users\")\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/utils/aws.py\", line 95, in async_paginate\n    async for page in paginator.paginate(**kwargs):\n        items.extend(page.get(result_key, []))\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 39, in __anext__\n    response = await self._make_request(current_kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 19, in _make_request\n    return await self._method(**current_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/client.py\", line 424, in _make_api_call\n    raise error_class(parsed_response, operation_name)\nbotocore.exceptions.ClientError: An error occurred (AccessDenied) when calling the ListUsers operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: iam:ListUsers on resource: arn:aws:iam::546493288314:user/ because no identity-based policy allows the iam:ListUsers action\n"}, "timestamp": 1771061749.781604}
{"hypothesisId": "H6", "location": "engine.py:collector_failed", "message": "collector EXCEPTION", "data": {"collector": "policy", "error": "An error occurred (AccessDenied) when calling the ListPolicies operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: iam:ListPolicies on resource: policy path / because no identity-based policy allows the iam:ListPolicies action", "traceback": "Traceback (most recent call last):\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/engine.py\", line 234, in run\n    stats = await collector.collect(account_id, region)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/collectors/policy.py\", line 55, in collect\n    raw_policies = await async_paginate(\n                   ^^^^^^^^^^^^^^^^^^^^^\n        iam, \"list_policies\", \"Policies\", Scope=\"Local\",\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/utils/aws.py\", line 95, in async_paginate\n    async for page in paginator.paginate(**kwargs):\n        items.extend(page.get(result_key, []))\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 39, in __anext__\n    response = await self._make_request(current_kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 19, in _make_request\n    return await self._method(**current_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/client.py\", line 424, in _make_api_call\n    raise error_class(parsed_response, operation_name)\nbotocore.exceptions.ClientError: An error occurred (AccessDenied) when calling the ListPolicies operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: iam:ListPolicies on resource: policy path / because no identity-based policy allows the iam:ListPolicies action\n"}, "timestamp": 1771061749.906521}
{"hypothesisId": "H6", "location": "engine.py:collector_failed", "message": "collector EXCEPTION", "data": {"collector": "resource", "error": "An error occurred (AccessDeniedException) when calling the ListFunctions operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: lambda:ListFunctions on resource: * because no identity-based policy allows the lambda:ListFunctions action", "traceback": "Traceback (most recent call last):\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/engine.py\", line 234, in run\n    stats = await collector.collect(account_id, region)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/collectors/resource.py\", line 74, in collect\n    stats[\"lambda_functions\"] = await self._collect_lambda(account_id, region)\n                                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/collectors/resource.py\", line 231, in _collect_lambda\n    raw_functions = await async_paginate(lam, \"list_functions\", \"Functions\")\n                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/utils/aws.py\", line 95, in async_paginate\n    async for page in paginator.paginate(**kwargs):\n        items.extend(page.get(result_key, []))\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 39, in __anext__\n    response = await self._make_request(current_kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 19, in _make_request\n    return await self._method(**current_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/client.py\", line 424, in _make_api_call\n    raise error_class(parsed_response, operation_name)\nbotocore.exceptions.ClientError: An error occurred (AccessDeniedException) when calling the ListFunctions operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: lambda:ListFunctions on resource: * because no identity-based policy allows the lambda:ListFunctions action\n"}, "timestamp": 1771061752.010808}
{"hypothesisId": "H6", "location": "engine.py:collector_failed", "message": "collector EXCEPTION", "data": {"collector": "backup", "error": "An error occurred (AccessDeniedException) when calling the ListProtectedResources operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: backup:ListProtectedResources because no identity-based policy allows the backup:ListProtectedResources action", "traceback": "Traceback (most recent call last):\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/engine.py\", line 234, in run\n    stats = await collector.collect(account_id, region)\n            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/collectors/backup.py\", line 85, in collect\n    protected = await self._collect_protected_resources(\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n        backup, account_id, region,\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/recon/collectors/backup.py\", line 142, in _collect_protected_resources\n    raw_items = await async_paginate(\n                ^^^^^^^^^^^^^^^^^^^^^\n        client, \"list_protected_resources\", \"Results\",\n        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n    )\n    ^\n  File \"/Users/omar/Desktop/Atlas/src/atlas/utils/aws.py\", line 95, in async_paginate\n    async for page in paginator.paginate(**kwargs):\n        items.extend(page.get(result_key, []))\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 39, in __anext__\n    response = await self._make_request(current_kwargs)\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/paginate.py\", line 19, in _make_request\n    return await self._method(**current_kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/context.py\", line 36, in wrapper\n    return await func(*args, **kwargs)\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/Users/omar/Desktop/Atlas/.venv/lib/python3.14/site-packages/aiobotocore/client.py\", line 424, in _make_api_call\n    raise error_class(parsed_response, operation_name)\nbotocore.exceptions.ClientError: An error occurred (AccessDeniedException) when calling the ListProtectedResources operation: User: arn:aws:iam::546493288314:user/mac_hacker is not authorized to perform: backup:ListProtectedResources because no identity-based policy allows the backup:ListProtectedResources action\n"}, "timestamp": 1771061752.19172}
{"hypothesisId": "H6", "location": "permission_resolver.py:collect_entry", "message": "collect() ENTERED", "data": {"account_id": "546493288314", "region": "us-east-1"}, "timestamp": 1771061752.1921878}
{"hypothesisId": "H1", "location": "permission_resolver.py:collect", "message": "pre-tier1", "data": {"identities": ["arn:aws:iam::546493288314:user/mac_hacker"], "caller_arn": "arn:aws:iam::546493288314:user/mac_hacker", "enable_sentinel": true}, "timestamp": 1771061752.1924329}
{"hypothesisId": "H1", "location": "permission_resolver.py:tier1_result", "message": "tier1 result", "data": {"tier1_success": false}, "timestamp": 1771061752.192598}
{"hypothesisId": "H2,H3", "location": "permission_resolver.py:bruteforce_start", "message": "bruteforce starting", "data": {"caller_arn": "arn:aws:iam::546493288314:user/mac_hacker", "probe_count": 84}, "timestamp": 1771061752.3958862}
{"hypothesisId": "H2,H3", "location": "permission_resolver.py:bruteforce_done", "message": "bruteforce done", "data": {"results": {"total": 83, "succeeded": 9, "denied": 74, "errors": 0}, "caller_arn": "arn:aws:iam::546493288314:user/mac_hacker", "allowed_count": 13, "allowed_perms": ["s3:ListBuckets", "sts:GetCallerIdentity", "sts:GetSessionToken", "s3:GetBucketLocation", "s3:GetPublicAccessBlock", "s3:GetBucketAcl", "s3:GetBucketPolicy", "s3:ListBucket", "s3:HeadBucket", "s3:PutObject", "s3:DeleteObject", "s3:PutBucketPolicy", "s3:GetObject"]}, "timestamp": 1771061754.1916642}
{"hypothesisId": "H4,H5", "location": "attack_graph.py:build", "message": "build start", "data": {"users": ["arn:aws:iam::546493288314:user/mac_hacker"], "roles": [], "buckets": ["arn:aws:s3:::atlas-test-bucket-please-work", "arn:aws:s3:::elasticbeanstalk-us-east-1-546493288314"], "has_pmap": true, "pmap_profiles": ["arn:aws:iam::546493288314:user/mac_hacker"]}, "timestamp": 1771061754.199564}
{"hypothesisId": "H5", "location": "attack_graph.py:s3_edges", "message": "s3 edge check", "data": {"identities": ["arn:aws:iam::546493288314:user/mac_hacker"], "buckets": ["arn:aws:s3:::atlas-test-bucket-please-work", "arn:aws:s3:::elasticbeanstalk-us-east-1-546493288314"], "checks": [{"id": "arn:aws:iam::546493288314:user/mac_hacker", "bucket": "arn:aws:s3:::atlas-test-bucket-please-work", "has_read": true, "has_write": true, "has_list": true}, {"id": "arn:aws:iam::546493288314:user/mac_hacker", "bucket": "arn:aws:s3:::elasticbeanstalk-us-east-1-546493288314", "has_read": true, "has_write": true, "has_list": true}]}, "timestamp": 1771061754.203118}
